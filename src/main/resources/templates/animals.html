<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
    <head>
        <meta charset="UTF-8">
        <title>Питомцы</title>
        <link rel="stylesheet" href="/css/animals.css">
    </head>
    <body>
        <header class="header">
            <div>
                <div sec:authorize="!isAuthenticated()">
                    <h4><a href="/login">Войти</a></h4>
                    <h4><a href="/registration">Зарегистрироваться</a></h4>
                </div>
                <div sec:authorize="isAuthenticated()">
                    <h4><a href="/logout">Выйти</a></h4>
                </div>
            </div>
            <div sec:authorize="hasAuthority('ROLE_ADMIN')">
                <a href="/admin/save">Добавить животное</a>
            </div>
        </header>
        <form class="filter" method="get" enctype="multipart/form-data" th:action="@{/filter}">
            <h3>Фильтр</h3>
            <div>
                <span>Возраст от</span>
                <input type="number" name="ageFrom" min="1" th:max="${ageMax}" th:value="${ageFrom}">
                <span>до</span>
                <input type="number" name="ageTo" min="1" th:max="${ageMax}" th:value="${ageTo}">
            </div>
            <div>
                <select name="type" value="CAT" defaultValue="CAT">
                    <option value="ALL">Все</option>
                    <option th:each="type : ${T(ru.matmex.animalshelter.model.AnimalType).values()}"
                            th:value="${type}" th:text="${type.displayValue}"></option>
                </select>
            </div>
            <button type="submit">Поиск</button>
        </form>
        <div class="pet-card" th:each="animal: ${animals}">
            <img class="pet-image" th:src="'data:image/jpeg;base64,' + ${animal.getImageBase64()}" alt="Фото питомца">
            <p sec:authorize="isAuthenticated()">
                <a th:text="${animal.name}" th:href="'/detailedAnimalInfo/' + ${animal.id}"></a>
            </p>
            <p sec:authorize="!isAuthenticated()" th:text="${animal.name}"></p>
            <th:block th:switch="${animal.age % 10}">
                <p th:case="'1'" th:text="'Возраст: ' + ${animal.age} + ' год'"></p>
                <p th:case="'2'" th:text="'Возраст: ' + ${animal.age} + ' года'"></p>
                <p th:case="'3'" th:text="'Возраст: ' + ${animal.age} + ' года'"></p>
                <p th:case="'4'" th:text="'Возраст: ' + ${animal.age} + ' года'"></p>
                <p th:case="*" th:text="'Возраст: ' + ${animal.age} + ' лет'"></p>
            </th:block>
        </div>
    </body>
</html>